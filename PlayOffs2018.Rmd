---
title: "MLB PLAYOFFS 2018"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r include=FALSE}
library(ggplot)
```


```{r echo = FALSE}
MLB2018r <- subset(mlb_elo, season == "2018", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

MLB2018 <- MLB2018 %>% clean_names() %>% mutate( team1 = as.factor(team1), team2 = as.factor(team2))
```


```{r echo = FALSE}
YANKS18H <- subset(MLB2018, team1 == "NYY", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

YANKS18A <- subset(MLB2018, team2 == "NYY", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

OAK18H <- subset(MLB2018, team1 == "OAK", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

OAK18A <- subset(MLB2018, team2 == "OAK", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))
```


#***Wild Card Games***


##***Yankees vs. A's***
###*$161,305,917 vs. $62,652,500*
```{r echo = FALSE}
YANKSHRs   <- MLB2018[MLB2018$team1=="NYY", "score1"]
YANKSHRa   <- MLB2018[MLB2018$team1=="NYY", "score2"]
YANKSARs   <- MLB2018[MLB2018$team2=="NYY", "score2"]
YANKSARa   <- MLB2018[MLB2018$team2=="NYY", "score1"]
NYYRsMELT  <- melt(c(YANKSHRs, YANKSARs), na.rm = TRUE)
NYYRaMELT  <- melt(c(YANKSHRa, YANKSARa), na.rm = TRUE)
NYYRs      <- data.frame(NYYRsMELT$value)
NYYRa      <- data.frame(NYYRaMELT$value)

LSnyyHRs   <- MLB2018[MLB2018$pitcher1=="Luis Severino", "score1"]
LSnyyHRa   <- MLB2018[MLB2018$pitcher1=="Luis Severino", "score2"]
LSnyyARs   <- MLB2018[MLB2018$pitcher2=="Luis Severino", "score2"]
LSnyyARa   <- MLB2018[MLB2018$pitcher2=="Luis Severino", "score1"]
LSnyyRMELT <- melt(c(LSevrHRs, LSevrARs), na.rm = TRUE)
LSnyyAMELT <- melt(c(LSevrHRa, LSevrARa), na.rm = TRUE)
LSnyyRs    <- data.frame(LSevRMELT$value)
LSnyyRa    <- data.frame(LSevAMELT$value)

OAKHRs     <- MLB2018[MLB2018$team1=="OAK", "score1"]
OAKHRa     <- MLB2018[MLB2018$team1=="OAK", "score2"]
OAKARs     <- MLB2018[MLB2018$team2=="OAK", "score2"]
OAKARa     <- MLB2018[MLB2018$team2=="OAK", "score1"]
OAKRsMELT  <- melt(c(OAKHRs, OAKARs), na.rm = TRUE)
OAKaMELT   <- melt(c(OAKHRa, OAKARa), na.rm = TRUE)
OAKRs      <- data.frame(OAKRsMELT$value)
OAKRa      <- data.frame(OAKaMELT$value)

LHoakHRs   <- MLB2018[MLB2018$pitcher1=="Liam Hendriks", "score1"]
LHoakHRa   <- MLB2018[MLB2018$pitcher1=="Liam Hendriks", "score2"]
LHoakARs   <- MLB2018[MLB2018$pitcher2=="Liam Hendriks", "score2"]
LHoakARa   <- MLB2018[MLB2018$pitcher2=="Liam Hendriks", "score1"]
LHoakRMELT <- melt(c(LHoakHRs, LHoakARs), na.rm = TRUE)
LHoakAMELT <- melt(c(LHoakHRa, LHoakARa), na.rm = TRUE)
LHoakRs    <- data.frame(LHoakRMELT$value)
LHoakRa    <- data.frame(LHoakAMELT$value)
```

```{r echo = FALSE}
print("New York SaberWin%")
sabermtrkk.WP(NYYRs, NYYRa)
print("Oakland As Saberwin%")
sabermtrkk.WP(OAKRs, OAKRa)
print("Luis Severino SaberWin%")
sabermtrkk.WP(LSnyyRs, LSnyyRa)
print("Liam Hendricks SaberWin%")
sabermtrkk.WP(LHoakRs, LHoakRa)
```




```{r echo = FALSE}
boxplot(c(NYYRa, OAKRa, NYYRs, OAKRs), horizontal = TRUE, names = c("NYY.RA", "OAK.RA", "NYY.Rs", "OAK.Rs"), main = "Yankees/A's", sub = "Runs Scored vs. Runs Allowed", col = c( "midnightblue", "forestgreen", "midnightblue", "forestgreen"), notch = TRUE, outline = FALSE, border = "goldenrod")
```




```{r echo = FALSE}
NYY18OAK     <- subset(YANKS18H, team2=="OAK", select = c(date, team1, team2, pitcher1, pitcher2, score1, score2), na.rm = TRUE)

OAK18NYY     <- subset(YANKS18A, team1=="OAK", select = c(date, team1, team2, pitcher1, pitcher2, score1, score2))

OAKvYANKS    <- melt(c(NYY18OAK$score1, OAK18NYY$score2))

YANKSvOAK    <- melt(c(NYY18OAK$score2, OAK18NYY$score1))
```

```{r echo = FALSE}
boxplot(c(OAKvYANKS, YANKSvOAK), horizontal = TRUE, names = c("OAK", "NYY"), main = "OAK vs NYY '18", sub = "Runs Scored against eachother", col = c("forestgreen", "midnightblue"), border = "goldenrod")
```



Average Runs Scored by the Yankees and Oakland against each other

```{r echo = FALSE}
print("OAK")
mean(OAKvYANKS$value, na.rm = TRUE)
print("NYY")
mean(YANKSvOAK$value, na.rm = TRUE)
```

###Result

####NYY 7 OAK 6

#&nbsp;

#&nbsp;

#&nbsp;


#***American League Division Series***

##*Yankees @ Red Sox*

```{r echo = FALSE}
#Red Sox 

REDSOX18H <- subset(MLB2018, team1 == "BOS", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

REDSOX18A <- subset(MLB2018, team2 == "BOS", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

BosRHRs    <- MLB2018[MLB2018$team1=="BOS", "score1"]
BosRHRa    <- MLB2018[MLB2018$team1=="BOS", "score2"]
BosRARs    <- MLB2018[MLB2018$team2=="BOS", "score2"]
BosRARa    <- MLB2018[MLB2018$team2=="BOS", "score1"]
BOSRsMELT  <- melt(c(BosRHRs, BosRARs), na.rm = TRUE)
BOSRaMELT  <- melt(c(BosRHRa, BosRARa), na.rm = TRUE)
BOSRs      <- data.frame(BOSRsMELT$value)
BOSRa      <- data.frame(BOSRaMELT$value)

#RED SOX PITCHERS
#Chris Sale
CSbosHRs   <- MLB2018[MLB2018$pitcher1=="Chris Sale", "score1"]
CSbosHRa   <- MLB2018[MLB2018$pitcher1=="Chris Sale", "score2"]
CSbosARs   <- MLB2018[MLB2018$pitcher2=="Chris Sale", "score2"]
CSbosARa   <- MLB2018[MLB2018$pitcher2=="Chris Sale", "score1"]
CSbosRMELT <- melt(c(CSbosHRs, CSbosARs), na.rm = TRUE)
CSbosAMELT <- melt(c(CSbosHRa, CSbosARa), na.rm = TRUE)
CSbosRs    <- data.frame(CSbosRMELT$value)
CSbosRa    <- data.frame(CSbosAMELT$value)

#David Price
DPbosHRs   <- MLB2018[MLB2018$pitcher1=="David Price", "score1"]
DPbosHRa   <- MLB2018[MLB2018$pitcher1=="David Price", "score2"]
DPbosARs   <- MLB2018[MLB2018$pitcher2=="David Price", "score2"]
DPbosARa   <- MLB2018[MLB2018$pitcher2=="David Price", "score1"]
DPbosRMELT <- melt(c(DPbosHRs, DPbosARs), na.rm = TRUE)
DPbosAMELT <- melt(c(DPbosHRa, DPbosARa), na.rm = TRUE)
DPbosRs    <- data.frame(DPbosRMELT$value)
DPbosRa    <- data.frame(DPbosAMELT$value)

#Rick Porcello
RPbosHRs   <- MLB2018[MLB2018$pitcher1=="Rick Porcello", "score1"]
RPbosHRa   <- MLB2018[MLB2018$pitcher1=="Rick Porcello", "score2"]
RPbosARs   <- MLB2018[MLB2018$pitcher2=="Rick Porcello", "score2"]
RPbosARa   <- MLB2018[MLB2018$pitcher2=="Rick Porcello", "score1"]
RPbosRMELT <- melt(c(RPbosHRs, RPbosARs), na.rm = TRUE)
RPbosAMELT <- melt(c(RPbosHRa, RPbosARa), na.rm = TRUE)
RPbosRs    <- data.frame(RPbosRMELT$value)
RPbosRa    <- data.frame(RPbosAMELT$value)

#Yankees Pitchers
#TBD


#Yankees vs. Red Sox 2018
NYY18BOS     <- subset(YANKS18H, team2=="BOS", select = c(date, team1, team2, pitcher1, pitcher2, score1, score2), na.rm = TRUE)

BOS18NYY     <- subset(YANKS18A, team1=="BOS", select = c(date, team1, team2, pitcher1, pitcher2, score1, score2))

BOSvNYY      <- melt(c(NYY18OAK$score1, OAK18NYY$score2))

NYYvBOS      <- melt(c(NYY18OAK$score2, OAK18NYY$score1))
```

####Sabermetric Win Percentage
```{r echo = FALSE}
print("Boston")
sabermtrkk.WP(BOSRs, BOSRa)
print("Yankees")
sabermtrkk.WP(NYYRs, NYYRa)
```

####Red Sox '18 Season and Yankes '18 Season

```{r echo = FALSE}
boxplot(c(NYYRa, BOSRa, NYYRs, BOSRs), horizontal = TRUE, names = c("NYY.RA", "BOS.RA", "NYY.Rs", "BOS.Rs"), main = "Yankees/A's", sub = "Runs Scored vs. Runs Allowed", col = c( "midnightblue", "red3", "midnightblue", "red3"), notch = TRUE, outline = FALSE, border = "darkgrey")

```

####Red Sox vs. Yankees '18

```{r echo = FALSE}
boxplot(c(BOSvNYY, NYYvBOS), horizontal = TRUE, names = c("BOS", "NYY"), main = "BOS vs NYY '18", sub = "Runs Scored against eachother", col = c("red3", "midnightblue"), border = "darkgrey")
```



####Friday @FENWAY
####*Chris Sale vs. TBD Sabermetric %*

```{r echo = FALSE}
print("Chris Sale")
sabermtrkk.WP(CSbosRs, CSbosRa)
print("TBD")
print("TBD")
```


####Saturday @FENWAY
####*David Price vs. TBD Sabermetric %*

```{r echo=FALSE}
print("David Price")
sabermtrkk.WP(DPbosRs, DPbosRa)
print("TBD")
print("TBD")
```

####Monday @ YANKEE STADIUM
####*TBD vs. Rick Porcello*

```{r}
print("TBD")
print("TBD")
print("Rick Porcello (BOS)")
sabermtrkk.WP(RPbosRs, RPbosRa)
```




#&nbsp;





##*Indians @ Astros*

```{r}
#Houston Home and Away
HOU18H <- subset(MLB2018, team1 == "HOU", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

HOU18A <- subset(MLB2018, team2 == "HOU", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

#Cleavland Home and Away
CLE18H <- subset(MLB2018, team1 == "CLE", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

CLE18A <- subset(MLB2018, team2 == "CLE", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))
```

```{r}
#Teams Sabermetrics

#Astros Team
HOUHRs     <- MLB2018[MLB2018$team1=="HOU", "score1"]
HOUHRa     <- MLB2018[MLB2018$team1=="HOU", "score2"]
HOUARs     <- MLB2018[MLB2018$team2=="HOU", "score2"]
HOUARa     <- MLB2018[MLB2018$team2=="HOU", "score1"]
HOURsMELT  <- melt(c(HOUHRs, HOUARs), na.rm = TRUE)
HOURaMELT  <- melt(c(HOUHRa, HOUARa), na.rm = TRUE)
HOURs      <- data.frame(HOURsMELT$value)
HOURa      <- data.frame(HOURaMELT$value)

#Astros Starting Pitching Rotation
JVhouHRs   <- MLB2018[MLB2018$pitcher1=="Justin Verlander", "score1"]
JVhouHRa   <- MLB2018[MLB2018$pitcher1=="Justin Verlander", "score2"]
JVhouARs   <- MLB2018[MLB2018$pitcher2=="Justin Verlander", "score2"]
JVhouARa   <- MLB2018[MLB2018$pitcher2=="Justin Verlander", "score1"]
JVhouRMELT <- melt(c(JVhouHRs, JVhouARs), na.rm = TRUE)
JVhouAMELT <- melt(c(JVhouHRa, JVhouARa), na.rm = TRUE)
JVhouRs    <- data.frame(JVhouRMELT$value)
JVhouRa    <- data.frame(JVhouAMELT$value)

#Cleveland
CLEHRs     <- MLB2018[MLB2018$team1=="CLE", "score1"]
CLEHRa     <- MLB2018[MLB2018$team1=="CLE", "score2"]
CLEARs     <- MLB2018[MLB2018$team2=="CLE", "score2"]
CLEARa     <- MLB2018[MLB2018$team2=="CLE", "score1"]
CLERsMELT  <- melt(c(CLEHRs, CLEARs), na.rm = TRUE)
CLEaMELT   <- melt(c(CLEHRa, CLEARa), na.rm = TRUE)
CLERs      <- data.frame(CLERsMELT$value)
CLERa      <- data.frame(CLEaMELT$value)

#Cleveland Starting Pitching Rotation
CKcleHRs   <- MLB2018[MLB2018$pitcher1=="Corey Kluber", "score1"]
CKcleHRa   <- MLB2018[MLB2018$pitcher1=="Corey Kluber", "score2"]
CKcleARs   <- MLB2018[MLB2018$pitcher2=="Corey Kluber", "score2"]
CKcleARa   <- MLB2018[MLB2018$pitcher2=="Corey Kluber", "score1"]
CKcleRMELT <- melt(c(CKcleHRs, CKcleARs), na.rm = TRUE)
CKcleAMELT <- melt(c(CKcleHRa, CKcleARa), na.rm = TRUE)
CKcleRs    <- data.frame(CKcleRMELT$value)
CKcleRa    <- data.frame(CKcleAMELT$value)
```

####Sabermetric Win Percentage

```{r}
print("Astros")
sabermtrkk.WP(HOURs, HOURa)
print("Indians")
sabermtrkk.WP(CLERs, CLERa)
```


####Houston '18 Season and Cleavland '18 Season

```{r}
boxplot(c(HOURa, CLERa, HOURs, CLERs), horizontal = TRUE, names = c("HOU.RA", "CLE.RA", "HOU.Rs", "CLE.Rs"), main = "Astros/Indians", sub = "Runs Scored vs. Runs Allowed", col = c( "darkorange2", "red", "darkorange2", "red"), notch = TRUE, outline = FALSE, border = "blue4")
```


```{r}
#Astros Vs. Indians 2018
HOU18CLE     <- subset(HOU18H, team2=="CLE", select = c(date, team1, team2, pitcher1, pitcher2, score1, score2), na.rm = TRUE)

CLE18HOU     <- subset(HOU18A, team1=="CLE", select = c(date, team1, team2, pitcher1, pitcher2, score1, score2))

HOUvCLE      <- melt(c(HOU18CLE$score1, CLE18HOU$score2))

CLEvHOU      <- melt(c(HOU18CLE$score2, CLE18HOU$score1))
```

####Houtson vs Cleavland '18

```{r}
boxplot(c(HOUvCLE, CLEvHOU), horizontal = TRUE, names = c("HOU", "CLE"), main = "HOU vs CLE '18", sub = "Runs Scored against eachother", col = c("darkorange2", "red"), border = "blue4")
```


###Friday @Minute Maid Park

####*Corey Kluber vs. Justin Verlander %*

```{r}
print("Corey Kluber")
sabermtrkk.WP(CKcleRs, CKcleRa)
print("Justin Verlander")
sabermtrkk.WP(JVhouRs, JVhouRa)
```

###Saturday @Minute Maid Park

####*






#&nbsp;

#&nbsp;


#***National League Division Series***

##*Rockies @ Brewers*


#####Series Viewer
```{r}
MILvCOL18DS <- mlb_elo %>%
  select(date, season, playoff, team1, team2, pitcher1, pitcher2, score1, score2) %>%
  filter(playoff == "d") %>%
  filter(team1 == "MIL" | team1 == "COL") %>%
  filter(season == "2018") %>%
  arrange(date) %>%
  select(date, team1, team2, pitcher1, pitcher2, score1, score2)

MILvCOL18DS

```


```{r}
#Teams home and away performance
MIL18H <- subset(MLB2018, team1 == "MIL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

MIL18A <- subset(MLB2018, team2 == "MIL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

COL18H <- subset(MLB2018, team1 == "COL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

COL18A <- subset(MLB2018, team2 == "COL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))
```


```{r}
#Brewers 

MIL18H <- subset(MLB2018, team1 == "MIL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

MIL18A <- subset(MLB2018, team2 == "MIL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

MILRHRs    <- MLB2018[MLB2018$team1=="MIL", "score1"]
MILRHRa    <- MLB2018[MLB2018$team1=="MIL", "score2"]
MILRARs    <- MLB2018[MLB2018$team2=="MIL", "score2"]
MILRARa    <- MLB2018[MLB2018$team2=="MIL", "score1"]
MILRsMELT  <- melt(c(MILRHRs, MILRARs), na.rm = TRUE)
MILRaMELT  <- melt(c(MILRHRa, MILRARa), na.rm = TRUE)
MILRs      <- data.frame(MILRsMELT$value)
MILRa      <- data.frame(MILRaMELT$value)

#Brewers PITCHERS
#Chris Sale
BWmilHRs   <- MLB2018[MLB2018$pitcher1=="Brandon Woodruff", "score1"]
BWmilHRa   <- MLB2018[MLB2018$pitcher1=="Brandon Woodruff", "score2"]
BWmilARs   <- MLB2018[MLB2018$pitcher2=="Brandon Woodruff", "score2"]
BWmilARa   <- MLB2018[MLB2018$pitcher2=="Brandon Woodruff", "score1"]
BWmilRMELT <- melt(c(BWmilHRs, BWmilARs), na.rm = TRUE)
BWmilAMELT <- melt(c(BWmilHRa, BWmilARa), na.rm = TRUE)
BWmilRs    <- data.frame(BWmilRMELT$value)
BWmilRa    <- data.frame(BWmilAMELT$value)

#Jhoulys Chacin
JCmilHRs   <- MLB2018[MLB2018$pitcher1=="Jhoulys Chacin", "score1"]
JCmilHRa   <- MLB2018[MLB2018$pitcher1=="Jhoulys Chacin", "score2"]
JCmilARs   <- MLB2018[MLB2018$pitcher2=="Jhoulys Chacin", "score2"]
JCmilARa   <- MLB2018[MLB2018$pitcher2=="Jhoulys Chacin", "score1"]
JCmilRMELT <- melt(c(JCmilHRs, JCmilARs), na.rm = TRUE)
JCmilAMELT <- melt(c(JCmilHRa, JCmilARa), na.rm = TRUE)
JCmilRs    <- data.frame(JCmilRMELT$value)
JCmilRa    <- data.frame(JCmilAMELT$value)


#Rockies

COL18H <- subset(MLB2018, team1 == "COL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

COL18A <- subset(MLB2018, team2 == "COL", select = c(date, playoff, season, team1, team2, pitcher1, pitcher2, score1, score2))

MILRHRs    <- MLB2018[MLB2018$team1=="COL", "score1"]
MILRHRa    <- MLB2018[MLB2018$team1=="COL", "score2"]
MILRARs    <- MLB2018[MLB2018$team2=="COL", "score2"]
MILRARa    <- MLB2018[MLB2018$team2=="COL", "score1"]
MILRsMELT  <- melt(c(MILRHRs, MILRARs), na.rm = TRUE)
MILRaMELT  <- melt(c(MILRHRa, MILRARa), na.rm = TRUE)
MILRs      <- data.frame(MILRsMELT$value)
MILRa      <- data.frame(MILRaMELT$value)

#Rockies PITCHERS
#Antonio Senzatela
AScolHRs   <- MLB2018[MLB2018$pitcher1=="Antonio Senzatela", "score1"]
AScolHRa   <- MLB2018[MLB2018$pitcher1=="Antonio Senzatela", "score2"]
AScolARs   <- MLB2018[MLB2018$pitcher2=="Antonio Senzatela", "score2"]
AScolARa   <- MLB2018[MLB2018$pitcher2=="Antonio Senzatela", "score1"]
AScolRMELT <- melt(c(AScolHRs, AScolARs), na.rm = TRUE)
AScolAMELT <- melt(c(AScolHRa, AScolARa), na.rm = TRUE)
AScolRs    <- data.frame(AScolRMELT$value)
AScolRa    <- data.frame(AScolAMELT$value)

```


































